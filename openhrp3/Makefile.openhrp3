INSTALL_DIR ?= $(CURDIR)
SVN_DIR     = build/OpenHRP-3.1
SVN_URL     = https://openrtp.org/svn/hrg/openhrp/3.1/trunk
#SVN_REVISION = -r@REVISION@
SVN_PATCH = patch/OpenHRP2ModelFile.patch patch/ColladaWriter_inertia.patch patch/SampleRobot.parameter.patch
SVN_CMDLINE = svn --non-interactive --trust-server-cert 
# https://openrtp.org/redmine/issues/2154, https://openrtp.org/redmine/issues/2162


include $(CURDIR)/svn_checkout.mk

installed: $(SVN_DIR) patched
	@echo "compile openhrp3 ... "
	@echo "                 PATH=$(PATH)"
	@echo "                 INSTALL_DIR=$(INSTALL_DIR)"
	@echo "                 OPENRTM_DIR=$(OPENRTM_DIR)"
	cd $(SVN_DIR) && cmake . -DCMAKE_INSTALL_PREFIX=$(INSTALL_DIR) -DENABLE_INSTALL_RPATH=ON -DENABLE_INSTALL_RPATH_TO_SELF=ON -DCOMPILE_JAVA_STUFF=OFF && make VERBOSE=1 && make install
	#
	# add link
	ln -sf SimulationEC.so $(INSTALL_DIR)/lib/libSimulationEC.so
        #
	touch installed

clean:
	-rm -fr installed patched include bin lib share build
